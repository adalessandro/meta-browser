From 5118b4069cdbe158fbae33a639c5543c56838229 Mon Sep 17 00:00:00 2001
From: Alexandros Frantzis <alexandros.frantzis@collabora.com>
Date: Fri, 11 Apr 2025 09:59:05 +0300
Subject: [PATCH] blink/renderer: Allow VBR mode on CBR-only encoders for
 webcodecs on Linux

---
 third_party/blink/renderer/modules/webcodecs/video_encoder.cc | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/third_party/blink/renderer/modules/webcodecs/video_encoder.cc b/third_party/blink/renderer/modules/webcodecs/video_encoder.cc
index 19b7efce40..7a52163120 100644
--- a/third_party/blink/renderer/modules/webcodecs/video_encoder.cc
+++ b/third_party/blink/renderer/modules/webcodecs/video_encoder.cc
@@ -175,7 +175,7 @@ media::VideoEncodeAccelerator::SupportedRateControlMode BitrateToSupportedMode(
       return media::VideoEncodeAccelerator::kConstantMode;
     case media::Bitrate::Mode::kVariable:
       return media::VideoEncodeAccelerator::kVariableMode
-#if BUILDFLAG(IS_ANDROID) || BUILDFLAG(IS_CHROMEOS)
+#if BUILDFLAG(IS_ANDROID) || BUILDFLAG(IS_CHROMEOS) || BUILDFLAG(IS_LINUX)
              // On Android and ChromeOS we allow CBR-only encoders to be used
              // for VBR because most devices don't properly advertise support
              // for VBR encoding. In most cases they will initialize
